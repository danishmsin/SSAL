Dataset multi Source real Target sketch Labeled num perclass 3 Network resnet34
126 classes in this dataset
Unlabelled Target Dataset Size:  23826
Labelled Target Dataset Size:  378
Misc. Labelled Target Dataset Size:  378
Bank keys - Target:  dict_keys(['feat_vec', 'labels', 'names', 'domain_identifier']) Source:  dict_keys(['feat_vec', 'labels', 'names', 'domain_identifier'])
Num  - Target:  23826 Source:  70358
Unlabeled Target Data Size: 496
S real T sketch Train Ep: 0 lr0.01 	 Loss Classification: 5.070074 Loss T 0.472035 Method MME

S real T sketch Train Ep: 100 lr0.009925650290240803 	 Loss Classification: 1.144333 Loss T 0.297277 Method MME

S real T sketch Train Ep: 200 lr0.009852577760521605 	 Loss Classification: 1.437594 Loss T 0.235433 Method MME

S real T sketch Train Ep: 300 lr0.009780748269686728 	 Loss Classification: 1.039159 Loss T 0.190854 Method MME

S real T sketch Train Ep: 400 lr0.009710128909124701 	 Loss Classification: 0.773767 Loss T 0.169591 Method MME

S real T sketch Train Ep: 500 lr0.00964068794694323 	 Loss Classification: 1.121980 Loss T 0.155825 Method MME


Labeled Target set: Average loss: 2.6983, Accuracy: 441/1080 F1 (40.8333%)


Test set: Average loss: 2.4580, Accuracy: 11217/23808 F1 (47.1144%)


Val set: Average loss: 2.2967, Accuracy: 176/360 F1 (48.8889%)

best acc test 47.114415  acc val 48.888889 acc labeled target 40.833333
saving model...
S real T sketch Train Ep: 600 lr0.00957239477517603 	 Loss Classification: 1.215974 Loss T 0.163200 Method MME

S real T sketch Train Ep: 700 lr0.009505219859830012 	 Loss Classification: 0.876106 Loss T 0.158330 Method MME

S real T sketch Train Ep: 800 lr0.009439134693595126 	 Loss Classification: 0.495314 Loss T 0.140205 Method MME

S real T sketch Train Ep: 900 lr0.009374111751051751 	 Loss Classification: 0.774907 Loss T 0.157277 Method MME

S real T sketch Train Ep: 1000 lr0.009310124446222227 	 Loss Classification: 0.568018 Loss T 0.131136 Method MME


Labeled Target set: Average loss: 2.4209, Accuracy: 532/1080 F1 (49.2593%)


Test set: Average loss: 2.3213, Accuracy: 12409/23808 F1 (52.1211%)


Val set: Average loss: 2.1931, Accuracy: 191/360 F1 (53.0556%)

best acc test 52.121136  acc val 53.055556 acc labeled target 49.259259
saving model...
S real T sketch Train Ep: 1100 lr0.00924714709232377 	 Loss Classification: 1.204219 Loss T 0.129438 Method MME

S real T sketch Train Ep: 1200 lr0.009185154863590003 	 Loss Classification: 0.509806 Loss T 0.123831 Method MME

S real T sketch Train Ep: 1300 lr0.00912412375903735 	 Loss Classification: 0.990081 Loss T 0.117547 Method MME

S real T sketch Train Ep: 1400 lr0.009064030568061049 	 Loss Classification: 0.702047 Loss T 0.139882 Method MME

S real T sketch Train Ep: 1500 lr0.009004852837753237 	 Loss Classification: 0.464664 Loss T 0.105606 Method MME


Labeled Target set: Average loss: 2.3834, Accuracy: 547/1080 F1 (50.6481%)


Test set: Average loss: 2.2722, Accuracy: 12920/23808 F1 (54.2675%)


Val set: Average loss: 2.0371, Accuracy: 198/360 F1 (55.0000%)

best acc test 54.267473  acc val 55.000000 acc labeled target 50.648148
saving model...
S real T sketch Train Ep: 1600 lr0.008946568841842816 	 Loss Classification: 0.238212 Loss T 0.141770 Method MME

S real T sketch Train Ep: 1700 lr0.008889157551163433 	 Loss Classification: 0.806651 Loss T 0.125502 Method MME

S real T sketch Train Ep: 1800 lr0.008832598605562044 	 Loss Classification: 0.537849 Loss T 0.140092 Method MME

S real T sketch Train Ep: 1900 lr0.008776872287166303 	 Loss Classification: 1.090485 Loss T 0.102724 Method MME

Per Class Accuracy Calculated According to the Labelled Target examples is:  [1.         1.         0.33333334 0.6666667  0.11111111 0.11111111
 0.33333334 0.7777778  0.8888889  0.11111111 0.8888889  1.
 0.         0.11111111 0.         1.         1.         0.6666667
 0.44444445 0.44444445 0.7777778  0.5555556  0.22222222 0.5555556
 0.5555556  0.33333334 0.         1.         0.5555556  0.6666667
 0.33333334 0.44444445 0.11111111 0.7777778  0.6666667  0.
 0.33333334 0.         0.6666667  0.8888889  0.6666667  0.6666667
 0.6666667  0.33333334 0.22222222 0.6666667  1.         0.44444445
 0.8333333  1.         0.5        0.33333334 1.         0.33333334
 0.44444445 0.6666667  0.7777778  0.6666667  0.6666667  0.8888889
 0.8888889  0.         1.         0.33333334 0.6666667  0.5555556
 0.11111111 0.6666667  0.         0.5555556  0.7777778  0.
 0.33333334 0.33333334 0.8888889  0.33333334 0.         0.5555556
 0.11111111 0.8888889  0.         0.16666667 0.33333334 0.6666667
 0.6666667  0.6666667  0.8888889  0.5        0.         0.33333334
 0.44444445 0.6666667  0.33333334 0.6666667  1.         0.44444445
 0.44444445 1.         0.22222222 0.         1.         0.5555556
 0.6666667  0.33333334 0.5        0.         0.33333334 0.44444445
 0.22222222 0.         0.5555556  0.33333334 0.5555556  1.
 0.44444445 0.6666667  0.11111111 0.6666667  0.         0.22222222
 0.7777778  0.8888889  0.8888889  0.         0.         1.        ]
Top k classes which perform poorly are:  [118, 88, 105, 14, 35, 12, 37, 76, 80, 71, 68, 99, 61, 124, 123, 109, 26, 116, 66, 78, 32, 5, 4, 9, 13, 81, 98, 44, 108, 22, 119, 43, 111, 53, 89, 51, 82, 25, 92, 72, 73, 30, 6, 2, 63, 103, 75, 36, 106, 96, 31, 54, 114, 47, 19, 18, 90, 107, 95, 87, 50, 104, 77, 69, 65, 112, 110, 101, 21, 23, 24, 28, 58, 91, 3, 17, 115, 85, 84, 83, 29, 34, 38, 102, 40, 41, 42, 45, 117, 55, 57, 67, 64, 93, 56, 33, 7, 70, 120, 20, 48, 8, 10, 122, 121, 79, 39, 59, 60, 74, 86, 113, 0, 62, 97, 94, 52, 49, 46, 27, 16, 15, 11, 1, 100, 125]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
Assigned Classwise weights to source
CBFL per class weights: tensor([1.0081, 0.9934, 1.0100, 1.0245, 0.9894, 1.0098, 1.0680, 0.9996, 0.9936,
        0.9909, 0.9987, 0.9884, 0.9914, 0.9887, 0.9903, 0.9892, 0.9886, 0.9894,
        0.9894, 0.9885, 1.0117, 0.9951, 0.9961, 0.9900, 1.0391, 0.9889, 0.9915,
        0.9891, 0.9884, 1.1139, 0.9989, 0.9934, 1.0294, 1.0075, 0.9896, 1.0568,
        1.0148, 0.9924, 0.9888, 0.9889, 0.9898, 0.9885, 0.9910, 0.9957, 0.9885,
        1.0054, 0.9910, 0.9885, 0.9892, 0.9943, 0.9885, 0.9962, 0.9924, 1.0153,
        0.9917, 1.0180, 0.9886, 0.9906, 0.9916, 0.9887, 0.9898, 1.0193, 0.9884,
        0.9900, 0.9896, 0.9902, 0.9931, 1.0087, 1.0037, 0.9937, 0.9994, 0.9896,
        0.9916, 0.9890, 0.9916, 1.2803, 0.9905, 0.9885, 0.9905, 0.9908, 1.0024,
        1.0004, 0.9892, 0.9978, 0.9890, 0.9911, 0.9895, 0.9892, 0.9903, 0.9900,
        0.9923, 0.9890, 0.9892, 0.9891, 0.9934, 0.9959, 1.0033, 0.9900, 1.0560,
        0.9884, 0.9908, 0.9918, 0.9946, 0.9900, 0.9907, 0.9890, 0.9985, 0.9976,
        0.9953, 0.9903, 1.0269, 0.9916, 0.9898, 0.9930, 1.0062, 0.9919, 0.9929,
        0.9903, 1.0165, 0.9891, 0.9892, 1.0148, 0.9898, 0.9893, 0.9893, 0.9891],
       device='cuda:0')
S real T sketch Train Ep: 2000 lr0.008721959494934213 	 Loss Classification: 0.671074 Loss T 0.110014 Method MME


Labeled Target set: Average loss: 2.4074, Accuracy: 540/1080 F1 (50.0000%)


Test set: Average loss: 2.4551, Accuracy: 12686/23808 F1 (53.2846%)


Val set: Average loss: 2.3889, Accuracy: 191/360 F1 (53.0556%)

best acc test 54.267473  acc val 53.055556 acc labeled target 50.000000
saving model...
S real T sketch Train Ep: 2100 lr0.008667841720414475 	 Loss Classification: 0.580179 Loss T 0.106296 Method MME

S real T sketch Train Ep: 2200 lr0.008614501024650454 	 Loss Classification: 0.774419 Loss T 0.119766 Method MME

S real T sketch Train Ep: 2300 lr0.008561920016164943 	 Loss Classification: 0.839433 Loss T 0.122856 Method MME

S real T sketch Train Ep: 2400 lr0.008510081829966844 	 Loss Classification: 0.754205 Loss T 0.093513 Method MME

S real T sketch Train Ep: 2500 lr0.008458970107524513 	 Loss Classification: 0.572924 Loss T 0.101861 Method MME


Labeled Target set: Average loss: 2.1064, Accuracy: 612/1080 F1 (56.6667%)


Test set: Average loss: 2.0795, Accuracy: 13940/23808 F1 (58.5517%)


Val set: Average loss: 1.8439, Accuracy: 216/360 F1 (60.0000%)

best acc test 58.551747  acc val 60.000000 acc labeled target 56.666667
saving model...
S real T sketch Train Ep: 2600 lr0.008408568977653933 	 Loss Classification: 1.030984 Loss T 0.114233 Method MME

S real T sketch Train Ep: 2700 lr0.00835886303827305 	 Loss Classification: 0.562166 Loss T 0.084523 Method MME

S real T sketch Train Ep: 2800 lr0.008309837338976545 	 Loss Classification: 0.650667 Loss T 0.092904 Method MME

S real T sketch Train Ep: 2900 lr0.008261477364388068 	 Loss Classification: 1.047106 Loss T 0.110978 Method MME

Per Class Accuracy Calculated According to the Labelled Target examples is:  [0.5        1.         0.5555556  1.         1.         0.16666667
 0.6666667  1.         0.7777778  0.         0.5        1.
 0.         0.44444445 0.5555556  0.5        1.         1.
 0.44444445 0.22222222 0.6666667  0.33333334 0.33333334 0.5
 0.7777778  0.11111111 0.         0.8888889  0.5555556  0.5555556
 0.6666667  0.         0.11111111 0.5555556  0.5555556  0.22222222
 0.         0.11111111 0.6666667  0.8888889  0.5555556  1.
 0.44444445 0.44444445 0.33333334 0.5555556  1.         0.44444445
 0.33333334 1.         0.33333334 0.33333334 1.         0.6666667
 0.33333334 0.44444445 1.         0.6666667  0.6666667  1.
 1.         0.33333334 1.         0.44444445 1.         0.6666667
 0.6666667  0.8888889  0.         0.6666667  1.         0.11111111
 0.22222222 0.44444445 1.         0.5555556  0.         0.8888889
 1.         0.6666667  0.         0.44444445 0.33333334 0.8333333
 0.6666667  1.         0.8888889  0.6666667  0.33333334 0.6666667
 0.5555556  0.6666667  0.5555556  0.8888889  1.         0.6666667
 0.6666667  1.         0.5555556  0.         0.8888889  0.6666667
 0.6666667  1.         0.6666667  0.         0.33333334 0.44444445
 0.         0.33333334 0.33333334 0.8333333  0.7777778  1.
 0.         1.         0.11111111 0.44444445 0.         0.33333334
 0.44444445 0.8888889  0.6666667  0.         0.         0.8888889 ]
Top k classes which perform poorly are:  [36, 31, 118, 12, 114, 26, 9, 80, 108, 105, 99, 76, 68, 123, 124, 37, 71, 32, 116, 25, 5, 35, 72, 19, 50, 82, 110, 88, 44, 54, 109, 61, 51, 22, 21, 48, 106, 119, 43, 42, 47, 13, 107, 117, 18, 120, 63, 73, 81, 55, 10, 23, 0, 15, 2, 75, 90, 92, 29, 98, 45, 34, 14, 40, 33, 28, 79, 87, 89, 91, 84, 101, 96, 95, 69, 104, 66, 122, 65, 58, 57, 53, 102, 38, 30, 20, 6, 112, 24, 8, 83, 111, 100, 121, 125, 93, 86, 77, 67, 27, 39, 1, 3, 4, 7, 11, 16, 17, 115, 113, 41, 49, 94, 52, 56, 59, 60, 64, 103, 70, 74, 78, 85, 97, 46, 62]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
Assigned Classwise weights to source
CBFL per class weights: tensor([1.0081, 0.9934, 1.0100, 1.0245, 0.9894, 1.0098, 1.0680, 0.9996, 0.9936,
        0.9909, 0.9987, 0.9884, 0.9914, 0.9887, 0.9903, 0.9892, 0.9886, 0.9894,
        0.9894, 0.9885, 1.0117, 0.9951, 0.9961, 0.9900, 1.0391, 0.9889, 0.9915,
        0.9891, 0.9884, 1.1139, 0.9989, 0.9934, 1.0294, 1.0075, 0.9896, 1.0568,
        1.0148, 0.9924, 0.9888, 0.9889, 0.9898, 0.9885, 0.9910, 0.9957, 0.9885,
        1.0054, 0.9910, 0.9885, 0.9892, 0.9943, 0.9885, 0.9962, 0.9924, 1.0153,
        0.9917, 1.0180, 0.9886, 0.9906, 0.9916, 0.9887, 0.9898, 1.0193, 0.9884,
        0.9900, 0.9896, 0.9902, 0.9931, 1.0087, 1.0037, 0.9937, 0.9994, 0.9896,
        0.9916, 0.9890, 0.9916, 1.2803, 0.9905, 0.9885, 0.9905, 0.9908, 1.0024,
        1.0004, 0.9892, 0.9978, 0.9890, 0.9911, 0.9895, 0.9892, 0.9903, 0.9900,
        0.9923, 0.9890, 0.9892, 0.9891, 0.9934, 0.9959, 1.0033, 0.9900, 1.0560,
        0.9884, 0.9908, 0.9918, 0.9946, 0.9900, 0.9907, 0.9890, 0.9985, 0.9976,
        0.9953, 0.9903, 1.0269, 0.9916, 0.9898, 0.9930, 1.0062, 0.9919, 0.9929,
        0.9903, 1.0165, 0.9891, 0.9892, 1.0148, 0.9898, 0.9893, 0.9893, 0.9891],
       device='cuda:0')
S real T sketch Train Ep: 3000 lr0.008213769018249545 	 Loss Classification: 0.658188 Loss T 0.111438 Method MME


Labeled Target set: Average loss: 2.4412, Accuracy: 562/1080 F1 (52.0370%)


Test set: Average loss: 2.2965, Accuracy: 13349/23808 F1 (56.0694%)


Val set: Average loss: 2.2205, Accuracy: 197/360 F1 (54.7222%)

best acc test 58.551747  acc val 54.722222 acc labeled target 52.037037
saving model...
S real T sketch Train Ep: 3100 lr0.008166698608209509 	 Loss Classification: 0.502996 Loss T 0.108248 Method MME

S real T sketch Train Ep: 3200 lr0.008120252831274708 	 Loss Classification: 0.231007 Loss T 0.104898 Method MME

S real T sketch Train Ep: 3300 lr0.008074418759891278 	 Loss Classification: 0.576423 Loss T 0.100363 Method MME

S real T sketch Train Ep: 3400 lr0.008029183828623731 	 Loss Classification: 0.414815 Loss T 0.116077 Method MME

S real T sketch Train Ep: 3500 lr0.007984535821401871 	 Loss Classification: 0.577519 Loss T 0.079007 Method MME


Labeled Target set: Average loss: 2.2127, Accuracy: 592/1080 F1 (54.8148%)


Test set: Average loss: 2.1275, Accuracy: 14257/23808 F1 (59.8832%)


Val set: Average loss: 2.0469, Accuracy: 200/360 F1 (55.5556%)

best acc test 58.551747  acc val 55.555556 acc labeled target 54.814815
saving model...
S real T sketch Train Ep: 3600 lr0.007940462859307384 	 Loss Classification: 0.616008 Loss T 0.088275 Method MME

S real T sketch Train Ep: 3700 lr0.007896953388873518 	 Loss Classification: 0.297090 Loss T 0.068613 Method MME

S real T sketch Train Ep: 3800 lr0.007853996170872714 	 Loss Classification: 0.172128 Loss T 0.073289 Method MME

S real T sketch Train Ep: 3900 lr0.00781158026956848 	 Loss Classification: 0.513800 Loss T 0.075960 Method MME

Per Class Accuracy Calculated According to the Labelled Target examples is:  [0.5        1.         0.         0.5555556  0.33333334 0.22222222
 0.6666667  1.         0.6666667  0.11111111 0.8888889  1.
 0.         0.11111111 0.8888889  0.5        0.44444445 1.
 0.5555556  0.         0.6666667  0.8888889  0.33333334 0.5555556
 0.33333334 0.33333334 0.         0.6666667  0.5555556  0.44444445
 0.22222222 0.33333334 0.7777778  0.44444445 0.33333334 0.
 0.8333333  0.         0.6666667  0.8888889  0.8888889  1.
 0.5555556  0.         0.33333334 0.6666667  1.         0.6666667
 0.         1.         0.33333334 0.22222222 1.         0.
 0.7777778  0.44444445 1.         1.         1.         0.8888889
 1.         0.         0.8888889  0.33333334 0.44444445 0.5555556
 0.16666667 0.33333334 0.11111111 1.         0.         0.33333334
 0.5555556  0.5        1.         0.5555556  0.11111111 0.5555556
 0.7777778  0.33333334 0.         0.8888889  0.22222222 0.33333334
 0.6666667  0.8888889  1.         0.6666667  0.         0.44444445
 0.33333334 1.         0.5555556  0.6666667  0.7777778  0.6666667
 0.5555556  0.8333333  0.         0.22222222 1.         0.6666667
 0.6666667  1.         0.6666667  0.         0.33333334 0.5555556
 0.11111111 0.5555556  0.5555556  0.5555556  1.         1.
 0.6666667  1.         0.         0.6666667  0.         0.33333334
 0.8888889  1.         0.6666667  0.         0.22222222 1.        ]
Top k classes which perform poorly are:  [61, 43, 70, 37, 35, 98, 26, 116, 19, 80, 118, 12, 53, 48, 123, 2, 105, 88, 68, 108, 76, 13, 9, 66, 30, 99, 124, 5, 51, 82, 67, 44, 83, 63, 71, 90, 22, 4, 79, 31, 119, 106, 25, 24, 50, 34, 64, 55, 29, 33, 16, 89, 73, 15, 0, 72, 75, 77, 96, 65, 109, 23, 28, 111, 18, 42, 110, 107, 3, 92, 87, 122, 6, 95, 8, 84, 117, 20, 102, 101, 27, 38, 114, 45, 47, 104, 93, 32, 54, 94, 78, 97, 36, 120, 62, 40, 85, 81, 39, 10, 59, 21, 14, 113, 115, 86, 112, 121, 7, 1, 17, 11, 41, 46, 49, 52, 56, 57, 58, 103, 60, 100, 69, 74, 91, 125]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
Assigned Classwise weights to source
CBFL per class weights: tensor([1.0081, 0.9934, 1.0100, 1.0245, 0.9894, 1.0098, 1.0680, 0.9996, 0.9936,
        0.9909, 0.9987, 0.9884, 0.9914, 0.9887, 0.9903, 0.9892, 0.9886, 0.9894,
        0.9894, 0.9885, 1.0117, 0.9951, 0.9961, 0.9900, 1.0391, 0.9889, 0.9915,
        0.9891, 0.9884, 1.1139, 0.9989, 0.9934, 1.0294, 1.0075, 0.9896, 1.0568,
        1.0148, 0.9924, 0.9888, 0.9889, 0.9898, 0.9885, 0.9910, 0.9957, 0.9885,
        1.0054, 0.9910, 0.9885, 0.9892, 0.9943, 0.9885, 0.9962, 0.9924, 1.0153,
        0.9917, 1.0180, 0.9886, 0.9906, 0.9916, 0.9887, 0.9898, 1.0193, 0.9884,
        0.9900, 0.9896, 0.9902, 0.9931, 1.0087, 1.0037, 0.9937, 0.9994, 0.9896,
        0.9916, 0.9890, 0.9916, 1.2803, 0.9905, 0.9885, 0.9905, 0.9908, 1.0024,
        1.0004, 0.9892, 0.9978, 0.9890, 0.9911, 0.9895, 0.9892, 0.9903, 0.9900,
        0.9923, 0.9890, 0.9892, 0.9891, 0.9934, 0.9959, 1.0033, 0.9900, 1.0560,
        0.9884, 0.9908, 0.9918, 0.9946, 0.9900, 0.9907, 0.9890, 0.9985, 0.9976,
        0.9953, 0.9903, 1.0269, 0.9916, 0.9898, 0.9930, 1.0062, 0.9919, 0.9929,
        0.9903, 1.0165, 0.9891, 0.9892, 1.0148, 0.9898, 0.9893, 0.9893, 0.9891],
       device='cuda:0')
S real T sketch Train Ep: 4000 lr0.007769695042409123 	 Loss Classification: 0.221253 Loss T 0.074008 Method MME


Labeled Target set: Average loss: 2.4736, Accuracy: 582/1080 F1 (53.8889%)


Test set: Average loss: 2.3616, Accuracy: 13808/23808 F1 (57.9973%)


Val set: Average loss: 2.2253, Accuracy: 199/360 F1 (55.2778%)

best acc test 58.551747  acc val 55.277778 acc labeled target 53.888889
saving model...
S real T sketch Train Ep: 4100 lr0.007728330130142108 	 Loss Classification: 0.090719 Loss T 0.083257 Method MME

S real T sketch Train Ep: 4200 lr0.007687475447329114 	 Loss Classification: 0.137703 Loss T 0.107548 Method MME

S real T sketch Train Ep: 4300 lr0.0076471211732427845 	 Loss Classification: 0.275343 Loss T 0.077996 Method MME

S real T sketch Train Ep: 4400 lr0.007607257743127307 	 Loss Classification: 0.974286 Loss T 0.083642 Method MME

S real T sketch Train Ep: 4500 lr0.007567875839805858 	 Loss Classification: 0.261149 Loss T 0.082345 Method MME


Labeled Target set: Average loss: 2.1857, Accuracy: 617/1080 F1 (57.1296%)


Test set: Average loss: 2.1519, Accuracy: 14522/23808 F1 (60.9963%)


Val set: Average loss: 1.9456, Accuracy: 217/360 F1 (60.2778%)

best acc test 60.996304  acc val 60.277778 acc labeled target 57.129630
saving model...
S real T sketch Train Ep: 4600 lr0.007528966385618854 	 Loss Classification: 0.507897 Loss T 0.077673 Method MME

S real T sketch Train Ep: 4700 lr0.007490520534677821 	 Loss Classification: 0.189707 Loss T 0.092865 Method MME

S real T sketch Train Ep: 4800 lr0.007452529665420465 	 Loss Classification: 0.658976 Loss T 0.092042 Method MME

S real T sketch Train Ep: 4900 lr0.007414985373453289 	 Loss Classification: 0.254446 Loss T 0.083436 Method MME

Per Class Accuracy Calculated According to the Labelled Target examples is:  [1.         1.         1.         0.6666667  0.8888889  0.22222222
 0.22222222 1.         0.7777778  0.         1.         1.
 0.11111111 0.11111111 0.5555556  0.16666667 0.8888889  0.8888889
 0.11111111 0.11111111 0.6666667  1.         0.6666667  1.
 0.33333334 0.33333334 0.         0.7777778  0.5555556  0.33333334
 0.6666667  0.22222222 0.11111111 0.5555556  0.33333334 0.33333334
 0.22222222 0.         1.         1.         0.6666667  1.
 0.7777778  0.44444445 0.44444445 0.5555556  1.         0.8333333
 0.33333334 1.         0.33333334 0.33333334 1.         0.44444445
 1.         0.5555556  0.7777778  0.5555556  0.8888889  0.8888889
 1.         0.33333334 0.8888889  0.33333334 0.7777778  0.5555556
 0.16666667 0.6666667  0.         1.         0.33333334 0.44444445
 0.6666667  0.5555556  1.         0.33333334 0.         0.8888889
 1.         0.5555556  0.         0.44444445 0.         0.5555556
 0.33333334 0.8888889  1.         0.6666667  0.33333334 0.44444445
 0.44444445 1.         0.6666667  0.8888889  0.7777778  0.5555556
 0.5555556  0.8888889  0.22222222 0.22222222 1.         0.5555556
 0.6666667  0.6666667  0.6666667  0.         0.33333334 0.5555556
 0.33333334 0.33333334 0.6666667  1.         0.8333333  1.
 0.7777778  1.         0.         0.6666667  0.22222222 0.33333334
 1.         0.6666667  0.6666667  0.         0.         0.7777778 ]
Top k classes which perform poorly are:  [26, 123, 105, 37, 76, 68, 80, 9, 124, 82, 116, 32, 19, 18, 12, 13, 66, 15, 118, 31, 5, 99, 36, 98, 6, 35, 88, 61, 75, 70, 106, 48, 50, 109, 108, 34, 29, 84, 51, 25, 24, 63, 119, 89, 81, 53, 44, 43, 90, 71, 101, 55, 57, 45, 73, 107, 65, 28, 96, 95, 79, 14, 83, 33, 87, 67, 72, 92, 102, 122, 3, 121, 117, 20, 110, 30, 22, 104, 103, 40, 27, 64, 42, 114, 8, 94, 56, 125, 112, 47, 97, 93, 62, 59, 85, 77, 17, 4, 16, 58, 113, 115, 11, 86, 21, 7, 120, 2, 1, 10, 111, 38, 91, 39, 41, 46, 49, 52, 54, 100, 60, 69, 74, 78, 23, 0]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
Assigned Classwise weights to source
CBFL per class weights: tensor([1.0081, 0.9934, 1.0100, 1.0245, 0.9894, 1.0098, 1.0680, 0.9996, 0.9936,
        0.9909, 0.9987, 0.9884, 0.9914, 0.9887, 0.9903, 0.9892, 0.9886, 0.9894,
        0.9894, 0.9885, 1.0117, 0.9951, 0.9961, 0.9900, 1.0391, 0.9889, 0.9915,
        0.9891, 0.9884, 1.1139, 0.9989, 0.9934, 1.0294, 1.0075, 0.9896, 1.0568,
        1.0148, 0.9924, 0.9888, 0.9889, 0.9898, 0.9885, 0.9910, 0.9957, 0.9885,
        1.0054, 0.9910, 0.9885, 0.9892, 0.9943, 0.9885, 0.9962, 0.9924, 1.0153,
        0.9917, 1.0180, 0.9886, 0.9906, 0.9916, 0.9887, 0.9898, 1.0193, 0.9884,
        0.9900, 0.9896, 0.9902, 0.9931, 1.0087, 1.0037, 0.9937, 0.9994, 0.9896,
        0.9916, 0.9890, 0.9916, 1.2803, 0.9905, 0.9885, 0.9905, 0.9908, 1.0024,
        1.0004, 0.9892, 0.9978, 0.9890, 0.9911, 0.9895, 0.9892, 0.9903, 0.9900,
        0.9923, 0.9890, 0.9892, 0.9891, 0.9934, 0.9959, 1.0033, 0.9900, 1.0560,
        0.9884, 0.9908, 0.9918, 0.9946, 0.9900, 0.9907, 0.9890, 0.9985, 0.9976,
        0.9953, 0.9903, 1.0269, 0.9916, 0.9898, 0.9930, 1.0062, 0.9919, 0.9929,
        0.9903, 1.0165, 0.9891, 0.9892, 1.0148, 0.9898, 0.9893, 0.9893, 0.9891],
       device='cuda:0')
S real T sketch Train Ep: 5000 lr0.007377879464668811 	 Loss Classification: 0.542679 Loss T 0.089281 Method MME


Labeled Target set: Average loss: 2.4712, Accuracy: 576/1080 F1 (53.3333%)


Test set: Average loss: 2.3760, Accuracy: 13805/23808 F1 (57.9847%)


Val set: Average loss: 2.1166, Accuracy: 216/360 F1 (60.0000%)

best acc test 60.996304  acc val 60.000000 acc labeled target 53.333333
saving model...
S real T sketch Train Ep: 5100 lr0.007341203948625087 	 Loss Classification: 0.528611 Loss T 0.064841 Method MME

S real T sketch Train Ep: 5200 lr0.007304951032175895 	 Loss Classification: 0.998561 Loss T 0.077809 Method MME

S real T sketch Train Ep: 5300 lr0.007269113113340497 	 Loss Classification: 0.408574 Loss T 0.084918 Method MME

S real T sketch Train Ep: 5400 lr0.007233682775402483 	 Loss Classification: 0.303134 Loss T 0.078310 Method MME

S real T sketch Train Ep: 5500 lr0.007198652781227704 	 Loss Classification: 0.707066 Loss T 0.062227 Method MME


Labeled Target set: Average loss: 2.3333, Accuracy: 593/1080 F1 (54.9074%)


Test set: Average loss: 2.1573, Accuracy: 14640/23808 F1 (61.4919%)


Val set: Average loss: 2.0469, Accuracy: 215/360 F1 (59.7222%)

best acc test 60.996304  acc val 59.722222 acc labeled target 54.907407
saving model...
S real T sketch Train Ep: 5600 lr0.007164016067791809 	 Loss Classification: 0.374804 Loss T 0.065322 Method MME

S real T sketch Train Ep: 5700 lr0.0071297657409083726 	 Loss Classification: 0.605643 Loss T 0.075690 Method MME

S real T sketch Train Ep: 5800 lr0.0070958950701490225 	 Loss Classification: 0.472306 Loss T 0.052345 Method MME

S real T sketch Train Ep: 5900 lr0.007062397483947426 	 Loss Classification: 0.335120 Loss T 0.070708 Method MME

Per Class Accuracy Calculated According to the Labelled Target examples is:  [0.6666667  1.         0.5555556  0.5555556  0.5        0.33333334
 0.6666667  1.         1.         0.11111111 0.8333333  1.
 0.         0.         1.         0.         0.7777778  1.
 0.7777778  0.11111111 0.5555556  1.         0.22222222 0.7777778
 0.44444445 0.22222222 0.         1.         0.6666667  0.33333334
 0.44444445 0.22222222 0.         0.33333334 0.11111111 0.
 0.33333334 0.         0.5555556  0.6666667  0.7777778  1.
 0.5555556  0.         0.11111111 0.6666667  1.         0.6666667
 0.5        1.         0.33333334 0.22222222 1.         0.33333334
 1.         0.6666667  0.6666667  0.6666667  1.         1.
 1.         0.33333334 0.8888889  0.33333334 0.8888889  0.6666667
 0.22222222 0.6666667  0.         1.         0.33333334 0.33333334
 0.8888889  0.22222222 0.8888889  0.33333334 0.11111111 1.
 1.         0.6666667  0.         0.8888889  0.33333334 0.22222222
 0.7777778  0.6666667  1.         0.6666667  0.         0.33333334
 0.33333334 0.8888889  0.5555556  0.7777778  1.         0.5
 0.33333334 0.8888889  0.6666667  0.6666667  0.7777778  0.5555556
 0.6666667  1.         0.7777778  0.         0.33333334 0.33333334
 0.         0.33333334 0.6666667  0.6666667  1.         1.
 1.         1.         0.22222222 0.5        0.         0.22222222
 1.         0.7777778  0.6666667  0.         0.11111111 0.6666667 ]
Top k classes which perform poorly are:  [35, 32, 105, 26, 88, 37, 108, 80, 15, 13, 12, 43, 118, 123, 68, 19, 9, 124, 44, 34, 76, 31, 51, 73, 116, 25, 66, 22, 83, 119, 89, 50, 82, 75, 90, 96, 61, 53, 63, 70, 29, 5, 109, 107, 36, 71, 106, 33, 24, 30, 4, 117, 48, 95, 3, 92, 101, 38, 20, 42, 2, 122, 99, 87, 110, 79, 85, 102, 98, 111, 0, 125, 28, 67, 6, 65, 45, 55, 39, 56, 47, 57, 40, 100, 93, 104, 23, 18, 16, 121, 84, 10, 97, 72, 62, 91, 74, 64, 81, 46, 1, 120, 7, 8, 77, 11, 115, 114, 113, 112, 14, 78, 17, 60, 21, 59, 27, 103, 58, 86, 54, 52, 69, 49, 94, 41]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
Assigned Classwise weights to source
CBFL per class weights: tensor([1.0081, 0.9934, 1.0100, 1.0245, 0.9894, 1.0098, 1.0680, 0.9996, 0.9936,
        0.9909, 0.9987, 0.9884, 0.9914, 0.9887, 0.9903, 0.9892, 0.9886, 0.9894,
        0.9894, 0.9885, 1.0117, 0.9951, 0.9961, 0.9900, 1.0391, 0.9889, 0.9915,
        0.9891, 0.9884, 1.1139, 0.9989, 0.9934, 1.0294, 1.0075, 0.9896, 1.0568,
        1.0148, 0.9924, 0.9888, 0.9889, 0.9898, 0.9885, 0.9910, 0.9957, 0.9885,
        1.0054, 0.9910, 0.9885, 0.9892, 0.9943, 0.9885, 0.9962, 0.9924, 1.0153,
        0.9917, 1.0180, 0.9886, 0.9906, 0.9916, 0.9887, 0.9898, 1.0193, 0.9884,
        0.9900, 0.9896, 0.9902, 0.9931, 1.0087, 1.0037, 0.9937, 0.9994, 0.9896,
        0.9916, 0.9890, 0.9916, 1.2803, 0.9905, 0.9885, 0.9905, 0.9908, 1.0024,
        1.0004, 0.9892, 0.9978, 0.9890, 0.9911, 0.9895, 0.9892, 0.9903, 0.9900,
        0.9923, 0.9890, 0.9892, 0.9891, 0.9934, 0.9959, 1.0033, 0.9900, 1.0560,
        0.9884, 0.9908, 0.9918, 0.9946, 0.9900, 0.9907, 0.9890, 0.9985, 0.9976,
        0.9953, 0.9903, 1.0269, 0.9916, 0.9898, 0.9930, 1.0062, 0.9919, 0.9929,
        0.9903, 1.0165, 0.9891, 0.9892, 1.0148, 0.9898, 0.9893, 0.9893, 0.9891],
       device='cuda:0')
S real T sketch Train Ep: 6000 lr0.007029266564879363 	 Loss Classification: 0.285062 Loss T 0.073711 Method MME


Labeled Target set: Average loss: 2.6031, Accuracy: 554/1080 F1 (51.2963%)


Test set: Average loss: 2.5310, Accuracy: 13576/23808 F1 (57.0229%)


Val set: Average loss: 2.3930, Accuracy: 202/360 F1 (56.1111%)

best acc test 60.996304  acc val 56.111111 acc labeled target 51.296296
saving model...
S real T sketch Train Ep: 6100 lr0.006996496045111504 	 Loss Classification: 0.254336 Loss T 0.055288 Method MME

S real T sketch Train Ep: 6200 lr0.00696407980201184 	 Loss Classification: 0.183120 Loss T 0.080669 Method MME

S real T sketch Train Ep: 6300 lr0.006932011853915101 	 Loss Classification: 0.262369 Loss T 0.079160 Method MME

S real T sketch Train Ep: 6400 lr0.006900286356036734 	 Loss Classification: 0.533113 Loss T 0.072899 Method MME

S real T sketch Train Ep: 6500 lr0.006868897596529406 	 Loss Classification: 0.569900 Loss T 0.067643 Method MME


Labeled Target set: Average loss: 2.2193, Accuracy: 618/1080 F1 (57.2222%)


Test set: Average loss: 2.2350, Accuracy: 14584/23808 F1 (61.2567%)


Val set: Average loss: 2.0282, Accuracy: 216/360 F1 (60.0000%)

best acc test 60.996304  acc val 60.000000 acc labeled target 57.222222
saving model...
S real T sketch Train Ep: 6600 lr0.006837839992676177 	 Loss Classification: 0.205943 Loss T 0.073324 Method MME

S real T sketch Train Ep: 6700 lr0.006807108087214876 	 Loss Classification: 0.727335 Loss T 0.060244 Method MME

S real T sketch Train Ep: 6800 lr0.006776696544788352 	 Loss Classification: 0.478112 Loss T 0.059933 Method MME

S real T sketch Train Ep: 6900 lr0.006746600148515609 	 Loss Classification: 0.367523 Loss T 0.081153 Method MME

Per Class Accuracy Calculated According to the Labelled Target examples is:  [0.44444445 1.         0.44444445 0.33333334 0.7777778  0.33333334
 0.6666667  1.         0.8888889  0.         0.6666667  1.
 0.11111111 0.         0.5        0.         1.         1.
 0.7777778  0.11111111 0.6666667  1.         0.16666667 0.7777778
 0.22222222 0.5555556  0.         1.         0.7777778  0.
 0.6666667  0.5555556  0.         0.44444445 0.6666667  0.33333334
 0.         0.         0.7777778  0.5555556  1.         1.
 0.7777778  0.33333334 0.33333334 0.5555556  0.8888889  0.8888889
 0.44444445 1.         0.         0.         1.         0.22222222
 0.44444445 1.         0.7777778  0.7777778  1.         1.
 1.         0.22222222 1.         0.6666667  0.6666667  0.6666667
 0.5555556  0.7777778  0.         1.         0.33333334 0.8888889
 0.22222222 0.44444445 1.         0.33333334 0.         1.
 0.6666667  0.5555556  0.         0.8888889  0.22222222 0.33333334
 0.44444445 1.         1.         0.6666667  0.         0.6666667
 0.33333334 0.8888889  0.6666667  1.         0.8888889  0.6666667
 0.5555556  0.8888889  0.         0.33333334 1.         0.33333334
 0.7777778  1.         0.6666667  0.         0.33333334 0.5555556
 0.11111111 0.33333334 0.5555556  0.8888889  0.7777778  0.8888889
 1.         1.         0.44444445 0.6666667  0.11111111 0.33333334
 0.7777778  0.8888889  0.7777778  0.         0.         0.        ]
Top k classes which perform poorly are:  [125, 29, 76, 80, 26, 50, 88, 36, 98, 15, 68, 13, 37, 105, 123, 51, 32, 9, 124, 108, 19, 12, 118, 22, 61, 53, 24, 82, 72, 35, 43, 44, 70, 83, 75, 90, 99, 101, 106, 109, 5, 3, 119, 84, 54, 116, 73, 48, 0, 2, 33, 14, 45, 31, 107, 96, 66, 79, 110, 25, 39, 30, 78, 87, 89, 92, 95, 10, 20, 34, 104, 117, 65, 6, 64, 63, 18, 57, 120, 4, 122, 112, 23, 28, 42, 102, 67, 38, 56, 97, 8, 46, 121, 94, 71, 91, 111, 81, 113, 47, 114, 1, 11, 115, 7, 49, 100, 52, 41, 55, 58, 59, 60, 40, 69, 74, 77, 27, 21, 85, 86, 93, 17, 16, 103, 62]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
Assigned Classwise weights to source
CBFL per class weights: tensor([1.0081, 0.9934, 1.0100, 1.0245, 0.9894, 1.0098, 1.0680, 0.9996, 0.9936,
        0.9909, 0.9987, 0.9884, 0.9914, 0.9887, 0.9903, 0.9892, 0.9886, 0.9894,
        0.9894, 0.9885, 1.0117, 0.9951, 0.9961, 0.9900, 1.0391, 0.9889, 0.9915,
        0.9891, 0.9884, 1.1139, 0.9989, 0.9934, 1.0294, 1.0075, 0.9896, 1.0568,
        1.0148, 0.9924, 0.9888, 0.9889, 0.9898, 0.9885, 0.9910, 0.9957, 0.9885,
        1.0054, 0.9910, 0.9885, 0.9892, 0.9943, 0.9885, 0.9962, 0.9924, 1.0153,
        0.9917, 1.0180, 0.9886, 0.9906, 0.9916, 0.9887, 0.9898, 1.0193, 0.9884,
        0.9900, 0.9896, 0.9902, 0.9931, 1.0087, 1.0037, 0.9937, 0.9994, 0.9896,
        0.9916, 0.9890, 0.9916, 1.2803, 0.9905, 0.9885, 0.9905, 0.9908, 1.0024,
        1.0004, 0.9892, 0.9978, 0.9890, 0.9911, 0.9895, 0.9892, 0.9903, 0.9900,
        0.9923, 0.9890, 0.9892, 0.9891, 0.9934, 0.9959, 1.0033, 0.9900, 1.0560,
        0.9884, 0.9908, 0.9918, 0.9946, 0.9900, 0.9907, 0.9890, 0.9985, 0.9976,
        0.9953, 0.9903, 1.0269, 0.9916, 0.9898, 0.9930, 1.0062, 0.9919, 0.9929,
        0.9903, 1.0165, 0.9891, 0.9892, 1.0148, 0.9898, 0.9893, 0.9893, 0.9891],
       device='cuda:0')
S real T sketch Train Ep: 7000 lr0.006716813796678979 	 Loss Classification: 0.240651 Loss T 0.051025 Method MME


Labeled Target set: Average loss: 2.9564, Accuracy: 543/1080 F1 (50.2778%)


Test set: Average loss: 2.7869, Accuracy: 13445/23808 F1 (56.4726%)


Val set: Average loss: 2.7687, Accuracy: 184/360 F1 (51.1111%)

best acc test 60.996304  acc val 51.111111 acc labeled target 50.277778
saving model...
S real T sketch Train Ep: 7100 lr0.006687332499522798 	 Loss Classification: 0.289810 Loss T 0.040464 Method MME

S real T sketch Train Ep: 7200 lr0.006658151376159165 	 Loss Classification: 0.702974 Loss T 0.074926 Method MME

S real T sketch Train Ep: 7300 lr0.00662926565157663 	 Loss Classification: 0.627828 Loss T 0.052634 Method MME

S real T sketch Train Ep: 7400 lr0.006600670653747793 	 Loss Classification: 0.056496 Loss T 0.057860 Method MME

S real T sketch Train Ep: 7500 lr0.0065723618108320175 	 Loss Classification: 0.677881 Loss T 0.079105 Method MME


Labeled Target set: Average loss: 0.0750, Accuracy: 1064/1080 F1 (98.5185%)


Test set: Average loss: 1.8983, Accuracy: 15893/23808 F1 (66.7549%)


Val set: Average loss: 1.6474, Accuracy: 239/360 F1 (66.3889%)

best acc test 66.754872  acc val 66.388889 acc labeled target 98.518519
saving model...
S real T sketch Train Ep: 7600 lr0.006544334648469591 	 Loss Classification: 0.519347 Loss T 0.046199 Method MME

S real T sketch Train Ep: 7700 lr0.006516584787163857 	 Loss Classification: 0.404165 Loss T 0.069030 Method MME

S real T sketch Train Ep: 7800 lr0.006489107939747966 	 Loss Classification: 0.884266 Loss T 0.046361 Method MME

S real T sketch Train Ep: 7900 lr0.0064618999089330565 	 Loss Classification: 0.466145 Loss T 0.056346 Method MME

Per Class Accuracy Calculated According to the Labelled Target examples is:  [1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        0.8888889 1.
 0.8888889 0.8888889 1.        1.        1.        0.8888889 1.
 1.        1.        1.        1.        1.        1.        1.
 0.8888889 1.        0.8888889 1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        0.8888889
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        0.8888889 1.
 1.        1.        1.        1.        1.        1.        1.
 1.        0.8888889 1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        0.5555556 1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 0.8333333 1.        1.        1.        1.        0.8888889 0.8888889
 1.        1.        1.        1.        1.        1.        1.       ]
Top k classes which perform poorly are:  [96, 112, 62, 33, 44, 29, 118, 117, 28, 85, 75, 26, 42, 86, 88, 89, 90, 87, 84, 81, 82, 91, 80, 79, 78, 77, 76, 74, 73, 72, 71, 70, 69, 68, 83, 92, 95, 94, 123, 122, 121, 120, 119, 116, 115, 114, 113, 111, 110, 109, 108, 107, 106, 105, 104, 103, 102, 101, 100, 99, 98, 97, 67, 93, 66, 0, 64, 27, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 30, 14, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 13, 31, 32, 34, 63, 124, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 43, 41, 40, 39, 38, 37, 36, 35, 65, 125]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
Assigned Classwise weights to source
CBFL per class weights: tensor([1.0081, 0.9934, 1.0100, 1.0245, 0.9894, 1.0098, 1.0680, 0.9996, 0.9936,
        0.9909, 0.9987, 0.9884, 0.9914, 0.9887, 0.9903, 0.9892, 0.9886, 0.9894,
        0.9894, 0.9885, 1.0117, 0.9951, 0.9961, 0.9900, 1.0391, 0.9889, 0.9915,
        0.9891, 0.9884, 1.1139, 0.9989, 0.9934, 1.0294, 1.0075, 0.9896, 1.0568,
        1.0148, 0.9924, 0.9888, 0.9889, 0.9898, 0.9885, 0.9910, 0.9957, 0.9885,
        1.0054, 0.9910, 0.9885, 0.9892, 0.9943, 0.9885, 0.9962, 0.9924, 1.0153,
        0.9917, 1.0180, 0.9886, 0.9906, 0.9916, 0.9887, 0.9898, 1.0193, 0.9884,
        0.9900, 0.9896, 0.9902, 0.9931, 1.0087, 1.0037, 0.9937, 0.9994, 0.9896,
        0.9916, 0.9890, 0.9916, 1.2803, 0.9905, 0.9885, 0.9905, 0.9908, 1.0024,
        1.0004, 0.9892, 0.9978, 0.9890, 0.9911, 0.9895, 0.9892, 0.9903, 0.9900,
        0.9923, 0.9890, 0.9892, 0.9891, 0.9934, 0.9959, 1.0033, 0.9900, 1.0560,
        0.9884, 0.9908, 0.9918, 0.9946, 0.9900, 0.9907, 0.9890, 0.9985, 0.9976,
        0.9953, 0.9903, 1.0269, 0.9916, 0.9898, 0.9930, 1.0062, 0.9919, 0.9929,
        0.9903, 1.0165, 0.9891, 0.9892, 1.0148, 0.9898, 0.9893, 0.9893, 0.9891],
       device='cuda:0')
S real T sketch Train Ep: 8000 lr0.006434956584934828 	 Loss Classification: 0.515253 Loss T 0.060003 Method MME


Labeled Target set: Average loss: 0.1156, Accuracy: 1047/1080 F1 (96.9444%)


Test set: Average loss: 2.1692, Accuracy: 15218/23808 F1 (63.9197%)


Val set: Average loss: 1.7157, Accuracy: 224/360 F1 (62.2222%)

best acc test 66.754872  acc val 62.222222 acc labeled target 96.944444
saving model...
S real T sketch Train Ep: 8100 lr0.006408273943175546 	 Loss Classification: 0.280208 Loss T 0.058058 Method MME

S real T sketch Train Ep: 8200 lr0.006381848042058713 	 Loss Classification: 0.137080 Loss T 0.073946 Method MME

S real T sketch Train Ep: 8300 lr0.0063556750208137005 	 Loss Classification: 0.156729 Loss T 0.046589 Method MME

S real T sketch Train Ep: 8400 lr0.006329751097407787 	 Loss Classification: 0.501440 Loss T 0.049352 Method MME

S real T sketch Train Ep: 8500 lr0.0063040725665231365 	 Loss Classification: 0.166401 Loss T 0.035859 Method MME


Labeled Target set: Average loss: 0.0623, Accuracy: 1064/1080 F1 (98.5185%)


Test set: Average loss: 1.9635, Accuracy: 16048/23808 F1 (67.4059%)


Val set: Average loss: 1.4696, Accuracy: 258/360 F1 (71.6667%)

best acc test 67.405914  acc val 71.666667 acc labeled target 98.518519
saving model...
S real T sketch Train Ep: 8600 lr0.006278635797596355 	 Loss Classification: 0.151181 Loss T 0.069732 Method MME

S real T sketch Train Ep: 8700 lr0.006253437232918371 	 Loss Classification: 0.533859 Loss T 0.051307 Method MME

S real T sketch Train Ep: 8800 lr0.0062284733857924735 	 Loss Classification: 0.007073 Loss T 0.075551 Method MME

S real T sketch Train Ep: 8900 lr0.006203740838748417 	 Loss Classification: 0.477364 Loss T 0.047496 Method MME

Per Class Accuracy Calculated According to the Labelled Target examples is:  [1.        1.        1.        1.        1.        1.        1.
 1.        1.        0.7777778 1.        1.        1.        1.
 0.8888889 1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        0.8888889 1.        1.
 1.        1.        1.        1.        1.        1.        1.
 0.8888889 1.        1.        1.        0.8333333 1.        1.
 0.8888889 1.        0.8888889 1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        0.6666667 1.
 1.        1.        1.        1.        1.        0.8888889 1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        0.8888889 0.8888889 1.        0.8888889 1.
 1.        0.8888889 1.        1.        1.        1.        0.8888889
 1.        1.        1.        1.        1.        1.        1.       ]
Top k classes which perform poorly are:  [68, 9, 39, 108, 107, 35, 25, 110, 14, 113, 44, 75, 42, 118, 87, 86, 85, 88, 89, 90, 84, 83, 0, 81, 80, 79, 78, 77, 76, 74, 73, 72, 71, 70, 69, 82, 91, 95, 93, 123, 122, 121, 120, 119, 117, 116, 115, 114, 112, 111, 109, 106, 105, 104, 103, 102, 101, 100, 99, 98, 97, 96, 67, 94, 92, 66, 62, 64, 29, 28, 27, 26, 24, 23, 22, 21, 20, 19, 18, 17, 30, 16, 13, 12, 11, 10, 8, 7, 6, 5, 4, 3, 2, 1, 15, 65, 31, 33, 63, 124, 61, 60, 59, 58, 57, 56, 55, 54, 53, 52, 32, 51, 49, 48, 47, 46, 45, 43, 41, 40, 38, 37, 36, 34, 50, 125]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
Assigned Classwise weights to source
CBFL per class weights: tensor([1.0081, 0.9934, 1.0100, 1.0245, 0.9894, 1.0098, 1.0680, 0.9996, 0.9936,
        0.9909, 0.9987, 0.9884, 0.9914, 0.9887, 0.9903, 0.9892, 0.9886, 0.9894,
        0.9894, 0.9885, 1.0117, 0.9951, 0.9961, 0.9900, 1.0391, 0.9889, 0.9915,
        0.9891, 0.9884, 1.1139, 0.9989, 0.9934, 1.0294, 1.0075, 0.9896, 1.0568,
        1.0148, 0.9924, 0.9888, 0.9889, 0.9898, 0.9885, 0.9910, 0.9957, 0.9885,
        1.0054, 0.9910, 0.9885, 0.9892, 0.9943, 0.9885, 0.9962, 0.9924, 1.0153,
        0.9917, 1.0180, 0.9886, 0.9906, 0.9916, 0.9887, 0.9898, 1.0193, 0.9884,
        0.9900, 0.9896, 0.9902, 0.9931, 1.0087, 1.0037, 0.9937, 0.9994, 0.9896,
        0.9916, 0.9890, 0.9916, 1.2803, 0.9905, 0.9885, 0.9905, 0.9908, 1.0024,
        1.0004, 0.9892, 0.9978, 0.9890, 0.9911, 0.9895, 0.9892, 0.9903, 0.9900,
        0.9923, 0.9890, 0.9892, 0.9891, 0.9934, 0.9959, 1.0033, 0.9900, 1.0560,
        0.9884, 0.9908, 0.9918, 0.9946, 0.9900, 0.9907, 0.9890, 0.9985, 0.9976,
        0.9953, 0.9903, 1.0269, 0.9916, 0.9898, 0.9930, 1.0062, 0.9919, 0.9929,
        0.9903, 1.0165, 0.9891, 0.9892, 1.0148, 0.9898, 0.9893, 0.9893, 0.9891],
       device='cuda:0')
S real T sketch Train Ep: 9000 lr0.006179236241810624 	 Loss Classification: 0.220646 Loss T 0.074018 Method MME


Labeled Target set: Average loss: 0.1060, Accuracy: 1052/1080 F1 (97.4074%)


Test set: Average loss: 2.2646, Accuracy: 15427/23808 F1 (64.7975%)


Val set: Average loss: 1.9382, Accuracy: 232/360 F1 (64.4444%)

best acc test 67.405914  acc val 64.444444 acc labeled target 97.407407
saving model...
S real T sketch Train Ep: 9100 lr0.006154956310818535 	 Loss Classification: 0.183262 Loss T 0.041857 Method MME

S real T sketch Train Ep: 9200 lr0.0061308978257973165 	 Loss Classification: 0.393009 Loss T 0.054265 Method MME

S real T sketch Train Ep: 9300 lr0.0061070576293771285 	 Loss Classification: 0.455798 Loss T 0.049521 Method MME

S real T sketch Train Ep: 9400 lr0.006083432625259276 	 Loss Classification: 0.495663 Loss T 0.046637 Method MME

S real T sketch Train Ep: 9500 lr0.006060019776727621 	 Loss Classification: 0.395565 Loss T 0.046249 Method MME


Labeled Target set: Average loss: 0.0483, Accuracy: 1069/1080 F1 (98.9815%)


Test set: Average loss: 2.0450, Accuracy: 16180/23808 F1 (67.9604%)


Val set: Average loss: 1.7027, Accuracy: 245/360 F1 (68.0556%)

best acc test 67.405914  acc val 68.055556 acc labeled target 98.981481
saving model...
S real T sketch Train Ep: 9600 lr0.00603681610520369 	 Loss Classification: 0.131233 Loss T 0.039968 Method MME

S real T sketch Train Ep: 9700 lr0.0060138186888439825 	 Loss Classification: 0.235887 Loss T 0.066030 Method MME

S real T sketch Train Ep: 9800 lr0.005991024661178045 	 Loss Classification: 0.095374 Loss T 0.043434 Method MME

S real T sketch Train Ep: 9900 lr0.0059684312097859115 	 Loss Classification: 0.612249 Loss T 0.036690 Method MME

Per Class Accuracy Calculated According to the Labelled Target examples is:  [1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        0.8888889 1.        1.        1.        1.
 1.        1.        1.        1.        1.        0.8888889 1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        0.8888889
 0.8888889 1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        0.8888889 1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        0.8888889 1.
 1.        0.8888889 1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 0.8888889 0.8888889 1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        0.8888889
 1.        1.        1.        1.        0.8888889 1.        1.       ]
Top k classes which perform poorly are:  [92, 40, 72, 106, 56, 118, 55, 30, 89, 123, 105, 86, 88, 85, 84, 83, 82, 81, 80, 87, 0, 90, 77, 76, 75, 74, 73, 71, 70, 69, 68, 67, 79, 78, 94, 93, 122, 121, 120, 119, 117, 116, 115, 114, 113, 112, 111, 110, 91, 109, 107, 104, 103, 102, 101, 100, 99, 98, 97, 96, 95, 66, 108, 65, 62, 63, 27, 26, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 28, 64, 29, 32, 124, 61, 60, 59, 58, 57, 54, 53, 52, 51, 50, 49, 48, 47, 46, 45, 44, 43, 42, 41, 39, 38, 37, 36, 35, 34, 33, 31, 125]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
Assigned Classwise weights to source
CBFL per class weights: tensor([1.0081, 0.9934, 1.0100, 1.0245, 0.9894, 1.0098, 1.0680, 0.9996, 0.9936,
        0.9909, 0.9987, 0.9884, 0.9914, 0.9887, 0.9903, 0.9892, 0.9886, 0.9894,
        0.9894, 0.9885, 1.0117, 0.9951, 0.9961, 0.9900, 1.0391, 0.9889, 0.9915,
        0.9891, 0.9884, 1.1139, 0.9989, 0.9934, 1.0294, 1.0075, 0.9896, 1.0568,
        1.0148, 0.9924, 0.9888, 0.9889, 0.9898, 0.9885, 0.9910, 0.9957, 0.9885,
        1.0054, 0.9910, 0.9885, 0.9892, 0.9943, 0.9885, 0.9962, 0.9924, 1.0153,
        0.9917, 1.0180, 0.9886, 0.9906, 0.9916, 0.9887, 0.9898, 1.0193, 0.9884,
        0.9900, 0.9896, 0.9902, 0.9931, 1.0087, 1.0037, 0.9937, 0.9994, 0.9896,
        0.9916, 0.9890, 0.9916, 1.2803, 0.9905, 0.9885, 0.9905, 0.9908, 1.0024,
        1.0004, 0.9892, 0.9978, 0.9890, 0.9911, 0.9895, 0.9892, 0.9903, 0.9900,
        0.9923, 0.9890, 0.9892, 0.9891, 0.9934, 0.9959, 1.0033, 0.9900, 1.0560,
        0.9884, 0.9908, 0.9918, 0.9946, 0.9900, 0.9907, 0.9890, 0.9985, 0.9976,
        0.9953, 0.9903, 1.0269, 0.9916, 0.9898, 0.9930, 1.0062, 0.9919, 0.9929,
        0.9903, 1.0165, 0.9891, 0.9892, 1.0148, 0.9898, 0.9893, 0.9893, 0.9891],
       device='cuda:0')
S real T sketch Train Ep: 10000 lr0.005946035575013605 	 Loss Classification: 0.196400 Loss T 0.057941 Method MME


Labeled Target set: Average loss: 0.1214, Accuracy: 1048/1080 F1 (97.0370%)


Test set: Average loss: 2.2345, Accuracy: 15556/23808 F1 (65.3394%)


Val set: Average loss: 1.8958, Accuracy: 225/360 F1 (62.5000%)

best acc test 67.405914  acc val 62.500000 acc labeled target 97.037037
saving model...
S real T sketch Train Ep: 10100 lr0.005923835048725393 	 Loss Classification: 0.198317 Loss T 0.062468 Method MME

S real T sketch Train Ep: 10200 lr0.005901826973091593 	 Loss Classification: 0.344311 Loss T 0.037978 Method MME

S real T sketch Train Ep: 10300 lr0.005880008739410735 	 Loss Classification: 0.832981 Loss T 0.060652 Method MME

S real T sketch Train Ep: 10400 lr0.005858377786964935 	 Loss Classification: 0.142760 Loss T 0.059075 Method MME

S real T sketch Train Ep: 10500 lr0.005836931601907399 	 Loss Classification: 0.358998 Loss T 0.030851 Method MME


Labeled Target set: Average loss: 0.0325, Accuracy: 1069/1080 F1 (98.9815%)


Test set: Average loss: 1.9551, Accuracy: 16404/23808 F1 (68.9012%)


Val set: Average loss: 1.5347, Accuracy: 257/360 F1 (71.3889%)

best acc test 67.405914  acc val 71.388889 acc labeled target 98.981481
saving model...
S real T sketch Train Ep: 10600 lr0.005815667716181004 	 Loss Classification: 0.400482 Loss T 0.038227 Method MME

S real T sketch Train Ep: 10700 lr0.005794583706466925 	 Loss Classification: 0.114985 Loss T 0.043453 Method MME

S real T sketch Train Ep: 10800 lr0.005773677193162352 	 Loss Classification: 0.171053 Loss T 0.034169 Method MME

S real T sketch Train Ep: 10900 lr0.005752945839386346 	 Loss Classification: 0.474654 Loss T 0.048567 Method MME

Per Class Accuracy Calculated According to the Labelled Target examples is:  [1.        1.        1.        0.8888889 1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        0.8888889 1.
 1.        1.        0.8888889 1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        0.8888889 1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        0.8888889 1.
 1.        1.        1.        1.        1.        1.        1.
 1.        0.8333333 1.        1.        1.        0.8888889 1.
 1.        0.8888889 1.        0.8888889 1.        0.8888889 1.
 1.        1.        0.8888889 1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.
 1.        1.        1.        1.        1.        1.        1.       ]
Top k classes which perform poorly are:  [71, 80, 78, 86, 75, 45, 26, 82, 3, 61, 30, 90, 91, 87, 85, 84, 83, 89, 88, 0, 92, 79, 77, 76, 74, 73, 72, 70, 69, 68, 67, 81, 93, 95, 66, 123, 122, 121, 120, 119, 118, 117, 116, 115, 114, 113, 112, 111, 94, 110, 108, 107, 106, 105, 104, 103, 102, 101, 100, 99, 98, 97, 96, 109, 65, 62, 63, 28, 27, 25, 24, 23, 22, 21, 20, 19, 18, 17, 16, 29, 15, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 2, 1, 14, 31, 32, 33, 124, 60, 59, 58, 57, 56, 55, 54, 53, 52, 51, 50, 49, 48, 47, 46, 44, 43, 42, 41, 40, 39, 38, 37, 36, 35, 34, 64, 125]
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
0
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
Assigned Classwise weights to source
CBFL per class weights: tensor([1.0081, 0.9934, 1.0100, 1.0245, 0.9894, 1.0098, 1.0680, 0.9996, 0.9936,
        0.9909, 0.9987, 0.9884, 0.9914, 0.9887, 0.9903, 0.9892, 0.9886, 0.9894,
        0.9894, 0.9885, 1.0117, 0.9951, 0.9961, 0.9900, 1.0391, 0.9889, 0.9915,
        0.9891, 0.9884, 1.1139, 0.9989, 0.9934, 1.0294, 1.0075, 0.9896, 1.0568,
        1.0148, 0.9924, 0.9888, 0.9889, 0.9898, 0.9885, 0.9910, 0.9957, 0.9885,
        1.0054, 0.9910, 0.9885, 0.9892, 0.9943, 0.9885, 0.9962, 0.9924, 1.0153,
        0.9917, 1.0180, 0.9886, 0.9906, 0.9916, 0.9887, 0.9898, 1.0193, 0.9884,
        0.9900, 0.9896, 0.9902, 0.9931, 1.0087, 1.0037, 0.9937, 0.9994, 0.9896,
        0.9916, 0.9890, 0.9916, 1.2803, 0.9905, 0.9885, 0.9905, 0.9908, 1.0024,
        1.0004, 0.9892, 0.9978, 0.9890, 0.9911, 0.9895, 0.9892, 0.9903, 0.9900,
        0.9923, 0.9890, 0.9892, 0.9891, 0.9934, 0.9959, 1.0033, 0.9900, 1.0560,
        0.9884, 0.9908, 0.9918, 0.9946, 0.9900, 0.9907, 0.9890, 0.9985, 0.9976,
        0.9953, 0.9903, 1.0269, 0.9916, 0.9898, 0.9930, 1.0062, 0.9919, 0.9929,
        0.9903, 1.0165, 0.9891, 0.9892, 1.0148, 0.9898, 0.9893, 0.9893, 0.9891],
       device='cuda:0')
S real T sketch Train Ep: 11000 lr0.005732387350012933 	 Loss Classification: 0.507362 Loss T 0.047783 Method MME


Labeled Target set: Average loss: 0.1265, Accuracy: 1049/1080 F1 (97.1296%)


Test set: Average loss: 2.1676, Accuracy: 15736/23808 F1 (66.0954%)


Val set: Average loss: 1.8889, Accuracy: 232/360 F1 (64.4444%)

best acc test 67.405914  acc val 64.444444 acc labeled target 97.129630
saving model...
S real T sketch Train Ep: 11100 lr0.005711999470730565 	 Loss Classification: 0.196602 Loss T 0.047862 Method MME

S real T sketch Train Ep: 11200 lr0.005691779987127103 	 Loss Classification: 0.858727 Loss T 0.041679 Method MME

S real T sketch Train Ep: 11300 lr0.005671726723799515 	 Loss Classification: 0.121646 Loss T 0.034139 Method MME

S real T sketch Train Ep: 11400 lr0.005651837543487509 	 Loss Classification: 0.314341 Loss T 0.052389 Method MME

S real T sketch Train Ep: 11500 lr0.005632110346230358 	 Loss Classification: 0.333073 Loss T 0.031102 Method MME


Labeled Target set: Average loss: 0.0402, Accuracy: 1073/1080 F1 (99.3519%)


Test set: Average loss: 2.0154, Accuracy: 16307/23808 F1 (68.4938%)


Val set: Average loss: 1.6189, Accuracy: 250/360 F1 (69.4444%)

best acc test 67.405914  acc val 69.444444 acc labeled target 99.351852
saving model...
S real T sketch Train Ep: 11600 lr0.005612543068546177 	 Loss Classification: 0.324991 Loss T 0.050028 Method MME

S real T sketch Train Ep: 11700 lr0.005593133682632953 	 Loss Classification: 0.443928 Loss T 0.037885 Method MME

